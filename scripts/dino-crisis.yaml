game_slug: dino-crisis
name: "Dino Crisis"
year: 1999
user: cunum
runner: wine
gogslug: dino_crisis
slug: dino-crisis-gog
version: GOG with Classic REbirth
notes: |
  Installs English/USA version from GOG and applies the Classic REbirth patch with working high quality FMVs. 
  
  You will need to following:
  - The game setup exe downloaded from your GOG library.

script:
  variables:
    SUBDIR: Dino Crisis
    EXE: DINO.exe
  files:
    - setup: N/A:GOG setup exe for Dino Crisis
    - patch:
        filename: DINO xp.7z
        url: https://classicrebirth.com/index.php/download/dino-crisis-windows-xp-patch/?wpdmdl=972&refresh=67a7a5c2c4ff11739040194
    - rebirth:
        filename: dc1cr 1.0.0 (2020-04-24).7z
        url: https://classicrebirth.com/index.php/download/dino-crisis-classic-rebirth/?wpdmdl=969&refresh=67a7a54eaa2ef1739040078
    - hq_textures:
        filename: HD_Mod_1.0.rar
        url: https://download2390.mediafire.com/wxcm3sde0abg_zOi60bYrMLW7y3xR4J3LIB4pbiKS5xTESXNhoXIawrvcXrpgQBLUbCz1fWDL-SoRkGOShycE4L-ysVHx0WwSTOQ0KbFknTjNiH24a9OelYZiwNL1NBj6SPwR8baQDSuzxicbQ2AnIk1W5BOBXNqDTrSTpDk7uZx/ozaua4228fffyia/HD_Mod_1.0.rar
    - hq_movie:
        filename: DINO_CRISIS_HQ_Movie.rar
        url: https://download1529.mediafire.com/ocmg7vsvwg7g8FUZWCc3V5Ueve_hq7-1hj4vIIgFEYjhRHgCSmnFvxkbLwLM0e6rKz9LYxhMewXpn2od0rZ7bzB6nyYA9hZ-OWFBdOBiuex67ygJ29CCD-ZetW4rt-1iT3NtT4yNrE8Wu-lCHUe-2WlJtCog7VOP24an-rsZQ7Gp/ay7dtr2mylsonch/DINO_CRISIS_HQ_MOVIE.rar
    - hq_audio:
        filename: DINO_CRISIS_HQ_(Voice)_and_(Background_Music)_updated.rar
        url: https://downloader.disk.yandex.ru/disk/3c0c2bf2431463fe1830fd51bd241a804e90b28e9828210f782d8a0cc1aa0e46/67a7e61f/6tlkAMnX-8Kgpqz5tu-8P1HkxnQPtaAHb3PWcB2Rtab4yUiihcNZIduuEGW4n93AlARqvYKzEPSpJjZkpV5bpA%3D%3D?uid=0&filename=DINO_CRISIS_HQ_(Voice)_and_(Background_Music)_updated.rar&disposition=attachment&hash=hy0%2B7Uk%2Bo3wPyijqm00GW88Rh6uuP259b5iOSlaaMWagKHJ57BpkqnDv4wIh6LR%2Fq%2FJ6bpmRyOJonT3VoXnDag%3D%3D&limit=0&content_type=application%2Fx-rar&owner_uid=219164244&fsize=304269968&hid=dcb2956611599284c41ca96862fef065&media_type=compressed&tknv=v2
  game:
    exe: drive_c/Games/$SUBDIR/$EXE
    prefix: $GAMEDIR
  installer:
    - task:
        description: Creating Wine prefix
        name: create_prefix
        prefix: $GAMEDIR
    - execute:
        command: |
          dpi=96
          [[ $RESOLUTION_WIDTH -gt $RESOLUTION_HEIGHT ]] && pixels=$RESOLUTION_HEIGHT || pixels=$RESOLUTION_WIDTH
          [[ $pixels -gt 1000 ]] && dpi=120
          [[ $pixels -gt 1400 ]] && dpi=144
          [[ $pixels -gt 2100 ]] && dpi=216
          WINEPREFIX="$GAMEDIR" "$WINEBIN" reg add "HKCU\Control Panel\Desktop" /v LogPixels /t REG_DWORD /d $dpi /f
    - execute:
        command: mkdir -p "$GAMEDIR/drive_c/Games/$SUBDIR"
    - task:
        args: /SILENT /LANG=jp /SP- /NOCANCEL /SUPPRESSMSGBOXES /NOGUI /DIR="$GAMEDIR/drive_c/Games/$SUBDIR/"
        executable: setup
        name: wineexec
    - extract:
        src: patch
        dst: $GAMEDIR/drive_c/Games/$SUBDIR/
        format: 7z
    - extract:
        src: rebirth
        dst: $GAMEDIR/drive_c/Games/$SUBDIR/
        format: 7z
    - extract:
        src: hq_textures
        dst: $GAMEDIR/drive_c/Games/$SUBDIR/
        format: rar
    - extract:
        src: hq_movie
        dst: $GAMEDIR/drive_c/Games/$SUBDIR/Movie/
        format: rar
    - extract:
        src: hq_audio
        dst: $CACHE
        format: rar
    - merge:
        description: Copying hq audio files...
        src: $CACHE/Sound/
        dst: $GAMEDIR/drive_c/Games/$SUBDIR/Sound/

  wine:
    dgvoodoo2: true
    overrides:
      ddraw: n,b